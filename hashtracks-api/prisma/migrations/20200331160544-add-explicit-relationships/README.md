# Migration `20200331160544-add-explicit-relationships`

This migration has been generated by its-kyle-yo at 3/31/2020, 4:05:44 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Commitment" ADD COLUMN "authorID" text  NOT NULL ;

ALTER TABLE "public"."Media" ADD COLUMN "postID" text  NOT NULL ;

ALTER TABLE "public"."Post" ADD COLUMN "authorID" text  NOT NULL ;

ALTER TABLE "public"."Commitment" ADD FOREIGN KEY ("authorID")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Media" ADD FOREIGN KEY ("postID")REFERENCES "public"."Post"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("authorID")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200327113920-init..20200331160544-add-explicit-relationships
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -17,9 +17,9 @@
   isSubscribed    Boolean      @default(false)
   isNewUser       Boolean      @default(true)
   profileImageUrl String
   name            String
-  commitments     Commitment[]
+  commitments     Commitment[] 
   posts           Post[]
   createdAt       DateTime     @default(now())
 }
@@ -28,9 +28,10 @@
   text         String
   type         String
   duration     Int
   durationType String
-  author       User
+  author       User @relation(fields: [authorID], references: [id])
+  authorID     String
 }
 model Post {
   id                String   @id @default(cuid())
@@ -40,14 +41,16 @@
   text              String
   source            String
   hashtags          String[]
   media             Media[]
-  author            User
+  author            User @relation(fields: [authorID], references: [id])
+  authorID          String
 }
 model Media {
   id             String  @id @default(cuid())
-  post           Post
+  post           Post   @relation(fields: [postID], references: [id])
+  postID         String
   twitterMediaID String  @unique
   imageUrl       String?
   videoUrl       String?
   type           String
```


